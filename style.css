:root {
  --bg1:#fff9fb;
  --bg2:#ffeef6;
  --accent:#ff4d94;
  --accent-dark:#8a003f;
  --heart:#ff9ac8;
}

*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:"Poppins",sans-serif;background:linear-gradient(180deg,var(--bg1),var(--bg2));overflow:hidden}

.stage{width:100%;height:100vh;display:flex;align-items:center;justify-content:center;position:relative}

/* === FLOWER STAGE === */
.flower-stage{
  position:absolute;inset:0;display:flex;flex-direction:column;
  align-items:center;justify-content:center;gap:20px;z-index:5;text-align:center;
}
.flower-wrap{display:flex;justify-content:center;width:100%;}
.flower-img{
  width:50%;max-width:580px;border-radius:12px;object-fit:cover;
  filter:drop-shadow(0 22px 40px rgba(170,50,120,0.1));
  animation:float 3s ease-in-out infinite;
}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
.open-btn{
  margin-top:20px;
  cursor:pointer;background:#fff;border:2px solid var(--accent);
  border-radius:50px;padding:12px 34px;font-size:22px;
  color:var(--accent-dark);font-family:"Great Vibes",cursive;
  box-shadow:0 10px 20px rgba(255,100,160,0.15);
  transition:transform .2s ease,box-shadow .2s ease;
  animation:float 3s ease-in-out infinite; /* same float as flower */
}
.open-btn:hover{transform:scale(1.06);box-shadow:0 12px 25px rgba(255,100,160,0.25);}

/* === ENVELOPE === */
.envelope-stage{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;z-index:20;}
.envelope-wrap{width:320px;height:240px;perspective:900px;}
.envelope-body{
  width:100%;height:100%;position:relative;background:linear-gradient(180deg,#ffd6ec,#ffb3d9);border-radius:12px;
  box-shadow:0 25px 60px rgba(255,100,160,0.2);transform-style:preserve-3d;
}
.envelope-flap{
  position:absolute;top:0;left:0;right:0;height:60%;
  background:linear-gradient(180deg,#ffb3d9,#ff94c2);
  clip-path:polygon(0 0,50% 75%,100% 0,100% 100%,0 100%);
  transform-origin:top center;transition:transform 900ms cubic-bezier(.2,.9,.2,1);
  border-top-left-radius:12px;border-top-right-radius:12px;
}
.envelope-open .envelope-flap{transform:rotateX(180deg) translateY(-16%);}

/* inner letter (realistic paper look) */
.envelope-inner{position:absolute;left:12px;right:12px;top:46%;bottom:14px;background:#fff;border-radius:8px;box-shadow:inset 0 3px 14px rgba(0,0,0,0.03);overflow:visible}

.inner-letter{
  position:absolute;
  left:8%;right:8%;bottom:6%;
  height:68%;
  background:linear-gradient(180deg,#fff,#fff9f9);
  border-radius:6px;
  border:1px solid rgba(255,180,205,0.7);
  box-shadow:0 20px 30px rgba(0,0,0,0.12);
  transform:translateY(110%) rotateX(0deg) scale(0.92);
  transform-origin:center bottom;
  opacity:0;
  transition:transform 1200ms cubic-bezier(.22,.9,.18,1),opacity 600ms ease;
  /* visual subtle fold/top */
}
.inner-letter::before{
  content:"";
  position:absolute;left:12px;right:12px;top:10px;height:2px;background:linear-gradient(90deg,rgba(0,0,0,0.03),rgba(0,0,0,0.01));
  border-radius:2px;opacity:.35;
}
.inner-letter.paper-curved{
  /* tiny curvature look */
  box-shadow: 0 24px 48px rgba(0,0,0,0.14), inset 0 -6px 20px rgba(255,180,200,0.04);
}

/* when letter begins to rise a bit out of envelope (visible but still mostly inside) */
.letter-partial{
  transform:translateY(-28%) rotateX(3deg) scale(1);
  opacity:1;
}

/* final cloned-to-center is handled in JS for precise sizing */

/* === LETTER STAGE === */
.letter-stage{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;z-index:60;pointer-events:none}
.heart-bg{
  position:absolute;inset:0;background:url('https://pngimg.com/uploads/heart/heart_PNG51337.png') center/contain no-repeat;
  opacity:0.14;z-index:0;animation:pulse 2s infinite;
}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.06)}}

canvas#fireworks{position:absolute;inset:0;z-index:1;pointer-events:none;}

#heartsContainer{position:absolute;inset:0;overflow:hidden;z-index:2;pointer-events:none}

.card{
  position:relative;background:#fff;padding:40px 60px;border-radius:18px;
  box-shadow:0 30px 90px rgba(255,100,160,0.25);
  transform:scale(0.5);opacity:0;transition:transform 700ms cubic-bezier(.2,.9,.2,1),opacity 700ms ease;
  text-align:center;z-index:3;
}
.card.show{transform:scale(1);opacity:1;}
.card-title{font-family:"Great Vibes",cursive;font-size:42px;color:var(--accent);margin-bottom:10px;}
.card-text{font-size:20px;line-height:1.25;color:var(--accent-dark);white-space:pre-line;}

.hidden{display:none;}
